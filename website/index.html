<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />

    <!-- p5.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/addons/p5.sound.min.js"></script>

    <!-- Base styles -->
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Share Your Love</title>
    <style>
      :root{
        /* 이 두 값은 JS에서 실시간 업데이트됩니다 */
        --bg1: 210 80% 16%; /* h s l (공백 구분) */
        --bg2: 210 70% 10%;
        --accent: 210 90% 65%;
      }
      * { box-sizing: border-box; }
      html, body {
        height: 100%;
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: #eaf2ff;
        background:
          radial-gradient(1200px 800px at 20% -10%, hsl(var(--bg1) / 0.65), transparent 60%),
          radial-gradient(1200px 800px at 120% 110%, hsl(var(--bg2) / 0.9), hsl(var(--bg2)));
        transition: background 600ms ease;
      }
      .wrap {
        min-height: 100%;
        display: grid;
        place-items: center;
        padding: 24px;
      }
      .card {
        width: 100%;
        max-width: 880px;
        background: hsl(225 28% 14% / 0.65);
        backdrop-filter: blur(12px);
        border: 1px solid hsl(220 20% 30% / 0.35);
        border-radius: 18px;
        box-shadow: 0 10px 40px hsl(220 30% 4% / 0.6);
        overflow: hidden;
      }
      header {
        padding: 20px 22px;
        background: linear-gradient(90deg, hsl(var(--accent) / 0.15), transparent 60%);
        border-bottom: 1px solid hsl(220 20% 30% / 0.35);
      }
      header h1 {
        margin: 0;
        font-weight: 700;
        letter-spacing: 0.2px;
        font-size: clamp(18px, 2.4vw, 28px);
      }
      .content {
        display: grid;
        grid-template-columns: 1fr;
        gap: 18px;
        padding: 18px;
      }
      .prompt {
        background: hsl(220 25% 16% / 0.55);
        border: 1px solid hsl(220 20% 28% / 0.35);
        border-radius: 14px;
        padding: 16px;
        line-height: 1.5;
        font-size: 15px;
      }
      .fields {
        display: grid;
        gap: 12px;
      }
      .field {
        display: grid;
        gap: 6px;
      }
      label { font-size: 14px; opacity: 0.9; }
      input[type="text"], input[type="number"]{
        width: 100%;
        padding: 12px 12px;
        border-radius: 12px;
        border: 1px solid hsl(220 20% 35% / 0.5);
        background: hsl(220 25% 12% / 0.6);
        color: #eaf2ff;
        outline: none;
      }
      input::placeholder { color: #b8c4d6; opacity: 0.6; }
      .actions {
        display: flex;
        gap: 10px;
        align-items: center;
        justify-content: flex-start;
      }
      button {
        padding: 12px 16px;
        border-radius: 12px;
        border: 1px solid hsl(220 20% 35% / 0.5);
        background: hsl(var(--accent) / 0.15);
        color: #eaf2ff;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.15s ease, background 0.2s ease, border-color 0.2s ease;
      }
      button:hover { transform: translateY(-1px); }
      button:active { transform: translateY(0px) scale(0.99); }

      .canvasWrap {
        background: linear-gradient(180deg, hsl(220 30% 12% / 0.6), transparent);
        border: 1px dashed hsl(220 20% 35% / 0.4);
        border-radius: 14px;
        padding: 10px;
      }

      footer{
        padding: 14px 18px 20px;
        font-size: 12px;
        opacity: 0.75;
      }

      @media (min-width: 880px){
        .content{
          grid-template-columns: minmax(280px, 1fr) minmax(360px, 1.3fr);
          align-items: start;
        }
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="card">
        <header>
          <h1>&lt;..I hope you could share your love here..&gt;</h1>
        </header>

        <div class="content">
          <div class="left">
            <div class="prompt">
              <p><strong>Question:</strong> What would you say to someone who may have a hard night with depression or suicidal thoughts?<br/>
              (Anyone could be your friend, family member, or someone close to you.)</p>
            </div>

            <div class="fields">
              <div class="field">
                <label for="word">I wish that you can give me some hopeful words or sentences:</label>
                <input id="word" type="text" placeholder="e.g., You matter. You’re not alone." />
              </div>

              <div class="field">
                <label for="score">What number is in your mind between 1–50 if you express your feelings in numbers?</label>
                <input id="score" type="number" min="1" max="50" placeholder="1–50" />
              </div>

              <div class="actions">
                <button id="submit">Submit</button>
              </div>
            </div>
          </div>

          <div class="right">
            <div class="canvasWrap">
              <!-- p5.js canvas will mount here -->
              <div id="p5-holder"></div>
            </div>
          </div>
        </div>

        <footer>
          Colors softly respond to what people share — higher numbers add energy; hopeful words add warmth.
        </footer>
      </div>
    </div>

    <!-- Your p5 sketch -->
    <script src="sketch.js"></script>
  </body>
</html>
sketch.js
javascript
Copy
Edit
/* Responsive, mood-reactive canvas + background/accents synced to inputs */

let cnv;
let particles = [];
let targetHue = 210;       // hue based on score
let targetWarm = 0.0;      // warmth from hopeful words
let currentHue = 210;
let currentWarm = 0.0;
let lastResize = 0;

// Create a sized canvas that stays "적당한 크기" (card 안에서 반응형)
function createOrResizeCanvas(){
  const holder = document.getElementById('p5-holder');
  const bounds = holder.getBoundingClientRect();

  // 적당한 비율/최대치
  const w = Math.min(Math.max(bounds.width - 20, 320), 760);
  const h = Math.min(Math.max(w * 0.48, 200), 380);

  if (!cnv){
    cnv = createCanvas(w, h);
    cnv.parent(holder);
  } else {
    resizeCanvas(w, h, true);
  }
}

function setup(){
  createOrResizeCanvas();
  noStroke();
  initParticles();

  // 입력 이벤트로 분위기 미리 반응
  const word = document.getElementById('word');
  const score = document.getElementById('score');
  const submit = document.getElementById('submit');

  word.addEventListener('input', onLiveWord);
  score.addEventListener('input', onLiveScore);
  submit.addEventListener('click', onSubmit);

  // 초기 스타일 동기화
  applyTheme();
}

function windowResized(){
  // 과도한 resize 호출 방지
  const now = millis();
  if (now - lastResize > 50){
    createOrResizeCanvas();
    lastResize = now;
  }
}

function draw(){
  // 부드러운 보간으로 색 이동
  currentHue = lerp(currentHue, targetHue, 0.02);
  currentWarm = lerp(currentWarm, targetWarm, 0.02);

  drawGradientBackground(currentHue, currentWarm);
  updateParticles(currentHue, currentWarm);

  // body & accent 색상도 프레임마다 조금씩 동기화
  applyTheme();
}

/* ---------- Mood Logic ---------- */
// 점수(1~50) -> 색조(hue) 매핑: 낮음=차분(200~220), 높음=활기(310~340)
function hueFromScore(n){
  // 맵핑 범위 약간 넓힘
  return map(n, 1, 50, 210, 330, true);
}

// 단어에서 warmth 추출: 길이 + 'love, hope, safe...' 포함 시 가중치
function warmthFromWords(text){
  const t = (text || "").toLowerCase();
  const base = constrain(t.length / 80, 0, 1); // 길이가 길수록 약간 따뜻하게
  const positives = ['love','lovely','hope','safe','breathe','calm','together','here','hold','light','kind','kindness','warm','trust','peace'];
  let bonus = 0;
  positives.forEach(p => {
    if (t.includes(p)) bonus += 0.12;
  });
  return constrain(base + bonus, 0, 1);
}

/* ---------- UI Handlers ---------- */
function onLiveWord(e){
  targetWarm = warmthFromWords(e.target.value);
}

function onLiveScore(e){
  const n = parseInt(e.target.value, 10);
  if (!isNaN(n)){
    targetHue = hueFromScore(n);
  }
}

function onSubmit(){
  // 제출 시 약간의 파티클 부스트(작은 축제 느낌)
  burstParticles(14 + floor(10 * currentWarm));
}

/* ---------- Theme & Drawing ---------- */
function applyTheme(){
  // warm이 높을수록 명도/채도 상승, hue는 score 기반
  const h1 = currentHue;
  const h2 = (currentHue + 30) % 360;

  const satBase = 70 + currentWarm * 20;
  const light1 = 14 + currentWarm * 8;
  const light2 = 10 + currentWarm * 10;

  const accentLight = 55 + currentWarm * 20;

  document.documentElement.style.setProperty('--bg1', `${h1} ${satBase}% ${light1}%`);
  document.documentElement.style.setProperty('--bg2', `${h2} ${satBase - 10}% ${light2}%`);
  document.documentElement.style.setProperty('--accent', `${h1} ${80 + currentWarm * 12}% ${accentLight}%`);
}

function drawGradientBackground(h, warm){
  // 캔버스 내에서도 은은한 그라데이션
  push();
  const cTop = color(h, 70 + warm*20, 16 + warm*10);
  const cBot = color((h+40)%360, 60 + warm*15, 8 + warm*12);
  for (let y=0; y<height; y++){
    const t = y / height;
    const c = lerpColor(cTop, cBot, t);
    stroke(c);
    line(0, y, width, y);
  }
  pop();
}

/* ---------- Particles ---------- */
function initParticles(){
  particles = [];
  for (let i=0;i<64;i++){
    particles.push(makeParticle());
  }
}

function burstParticles(n){
  for (let i=0;i<n;i++){
    particles.push(makeParticle(true));
  }
  // 제한
  if (particles.length > 140){
    particles.splice(0, particles.length - 140);
  }
}

function makeParticle(burst=false){
  const angle = random(TWO_PI);
  const radius = burst ? random(10, 40) : random(60, min(width, height)/2);
  const cx = width/2 + cos(angle) * radius;
  const cy = height/2 + sin(angle) * radius;
  return {
    x: cx,
    y: cy,
    vx: random(-0.6, 0.6),
    vy: random(-0.6, 0.6),
    life: burst ? random(70, 140) : random(120, 220),
    size: random(2, 5),
  };
}

function updateParticles(h, warm){
  const amp = 0.25 + warm * 0.7; // warm이 높을수록 요동
  const c = color(h, 80, 60 + warm*20, 0.65);

  particles.forEach(p => {
    p.vx += (noise(p.x*0.003, p.y*0.003, frameCount*0.002)-0.5) * 0.06 * (1+warm);
    p.vy += (noise(p.y*0.003, p.x*0.003, frameCount*0.002)-0.5) * 0.06 * (1+warm);
    p.x += p.vx * amp;
    p.y += p.vy * amp;
    p.life -= 0.8;

    // 화면 가장자리에서 부드럽게 감싸기
    if (p.x < -10) p.x = width + 10;
    if (p.x > width + 10) p.x = -10;
    if (p.y < -10) p.y = height + 10;
    if (p.y > height + 10) p.y = -10;

    // 그리기
    push();
    noStroke();
    fill(c);
    circle(p.x, p.y, p.size + warm*3);
    pop();
  });

  // 수명 지난 파티클 제거
  particles = particles.filter(p => p.life > 0);
}

/* ---------- Color Mode ---------- */
function preload(){
  // p5의 HSL 사용
  colorMode(HSL, 360, 100, 100, 1);
}
