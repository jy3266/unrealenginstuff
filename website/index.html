<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Share Your Love</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- p5.js (keep existing functionality) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/addons/p5.sound.min.js"></script>
    <link rel="stylesheet" href="style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700&display=swap" rel="stylesheet" />

    <style>
      :root{
        --bg1:#0f172a;   /* will be updated by JS */
        --bg2:#1e293b;   /* will be updated by JS */
        --accent:#60a5fa;/* will be updated by JS */
        --card:#0b1220cc;
        --text:#e5e7eb;
        --muted:#93a1b3;
      }

      *{box-sizing:border-box}
      html,body{
        height:100%;
        margin:0;
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
        color:var(--text);
        background: radial-gradient(1200px 800px at 20% 10%, var(--bg1), transparent 60%),
                    radial-gradient(1000px 700px at 80% 90%, var(--bg2), transparent 60%),
                    linear-gradient(160deg, var(--bg1), var(--bg2));
        transition: background 600ms ease;
      }

      .wrap{
        min-height:100%;
        display:grid;
        grid-template-rows:auto 1fr auto;
      }

      header{
        padding:32px 16px 8px;
        text-align:center;
      }
      h1{
        margin:0 auto 10px;
        font-size: clamp(1.2rem, 3vw, 1.8rem);
        font-weight:700;
        letter-spacing:.2px;
        background: linear-gradient(90deg, #fff, var(--accent));
        -webkit-background-clip:text;
        background-clip:text;
        color:transparent;
      }
      .tagline{
        margin:0 auto;
        color:var(--muted);
        font-size: .95rem;
      }

      .panel{
        width:min(960px, 92vw);
        margin:28px auto 24px;
        padding:24px;
        background: var(--card);
        border:1px solid rgba(255,255,255,.08);
        backdrop-filter: blur(8px);
        border-radius:20px;
        box-shadow:
          0 10px 30px rgba(0,0,0,.35),
          0 0 0 1px rgba(255,255,255,.04) inset;
      }

      .question{
        margin:0 0 18px;
        padding:16px 14px;
        border-radius:14px;
        background: rgba(255,255,255,.04);
        border:1px solid rgba(255,255,255,.06);
        text-align:center;
        line-height:1.6;
      }

      .grid{
        display:grid;
        grid-template-columns: 1fr;
        gap:14px;
      }

      label{
        display:block;
        font-size:.92rem;
        color:var(--muted);
        margin: 2px 2px 8px;
      }

      input{
        width:100%;
        padding:14px 12px;
        border-radius:12px;
        border:1px solid rgba(255,255,255,.12);
        background:#0b1220;
        color:var(--text);
        outline:none;
        transition: border-color .2s ease, box-shadow .2s ease;
      }
      input:focus{
        border-color: var(--accent);
        box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 25%, transparent);
      }

      .controls{
        display:flex;
        align-items:center;
        gap:12px;
        margin-top:4px;
      }

      #submit{
        padding:12px 18px;
        border:none;
        border-radius:12px;
        background: var(--accent);
        color:#0b1220;
        font-weight:700;
        cursor:pointer;
        transition: transform .05s ease, filter .2s ease, box-shadow .2s ease;
        box-shadow: 0 10px 24px color-mix(in srgb, var(--accent) 45%, transparent);
      }
      #submit:active{ transform: translateY(1px); }
      #submit:hover{ filter: brightness(1.05); }

      .swatch{
        width:36px;
        height:36px;
        border-radius:12px;
        border:1px solid rgba(255,255,255,.15);
        background: linear-gradient(135deg, var(--bg1), var(--bg2));
        box-shadow: inset 0 0 20px rgba(255,255,255,.06);
      }

      .canvas-frame{
        width:min(960px, 92vw);
        margin: 8px auto 40px;
        border-radius:18px;
        padding:10px;
        background: rgba(255,255,255,.03);
        border:1px solid rgba(255,255,255,.08);
      }

      /* Keep p5 canvas at a sensible visual size */
      canvas{
        display:block;
        width:min(900px, 90vw) !important; /* scales visually */
        height:auto !important;
        margin: 0 auto;
        border-radius:16px;
        box-shadow: 0 10px 28px rgba(0,0,0,.35);
      }

      footer{
        text-align:center;
        color:var(--muted);
        font-size:.85rem;
        padding: 0 0 24px;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <header>
        <h1>&lt;..I hope you could share your love here..&gt;</h1>
        <p class="tagline">Your words and feelings gently color this space.</p>
      </header>

      <section class="panel" aria-labelledby="question">
        <p id="question" class="question">
          <strong>Question</strong> : What would you say to someone who may have a hard night with depression or suicidal thoughts?<br />
          <em>(It could be a friend, family member, or anyone close to you.)</em>
        </p>

        <div class="grid">
          <div>
            <label for="word">I wish that you can give me some hopeful words or sentences:</label>
            <input id="word" placeholder="e.g., You are not alone. I’m here with you." />
          </div>

          <div>
            <label for="score">What number (1–50) is in your mind if you express your feelings in numbers?</label>
            <div class="controls">
              <input id="score" inputmode="numeric" pattern="[0-9]*" placeholder="e.g., 27" />
              <div class="swatch" title="Current mood colors"></div>
              <button id="submit" type="button" aria-label="Submit">submit</button>
            </div>
          </div>
        </div>
      </section>

      <section class="canvas-frame">
        <!-- If your sketch creates a canvas, we’ll nest it here automatically -->
        <div id="p5-holder" aria-label="Interactive canvas area"></div>
      </section>

      <footer>
        If you or someone you know is in immediate danger, please seek local emergency help.
      </footer>
    </div>

    <!-- keep your existing p5 sketch -->
    <script src="sketch.js"></script>

    <!-- Ambient theme logic (colors change with responses) -->
    <script>
      (function(){
        const wordEl  = document.getElementById('word');
        const scoreEl = document.getElementById('score');
        const submit  = document.getElementById('submit');
        const swatch  = document.querySelector('.swatch');

        // palettes mapped by tone
        const palettes = {
          stormy : ['#0f172a','#43336d','#7c3aed'],   // low energy / heavy
          dusk   : ['#1e1b4b','#312e81','#6d28d9'],   // anxious / tense
          calm   : ['#0f766e','#0ea5e9','#22d3ee'],   // steady / calm
          hopeful: ['#16a34a','#22c55e','#86efac'],   // growing / hopeful
          sunrise: ['#f59e0b','#f97316','#fca5a5']    // warm / supportive
        };

        function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

        function toneFromInputs(text, n){
          const t = (text || '').toLowerCase();

          // word-driven hints (very lightweight)
          if (/(love|hope|together|with you|괜찮|사랑|희망|함께)/i.test(t)) return 'sunrise';
          if (/(breathe|calm|호흡|숨|고요)/i.test(t)) return 'calm';
          if (/(anx|불안|nervous|긴장)/i.test(t)) return 'dusk';
          if (/(sad|아파|힘들|외롭|lonely|pain)/i.test(t)) return 'stormy';

          // score-driven fallback
          if (!isNaN(n)){
            if (n <= 10) return 'stormy';
            if (n <= 20) return 'dusk';
            if (n <= 30) return 'calm';
            if (n <= 40) return 'hopeful';
            return 'sunrise';
          }
          return 'calm';
        }

        function applyPalette(kind){
          const [bg1,bg2,accent] = palettes[kind] || palettes.calm;
          document.documentElement.style.setProperty('--bg1', bg1);
          document.documentElement.style.setProperty('--bg2', bg2);
          document.documentElement.style.setProperty('--accent', accent);
          if (swatch) swatch.style.background = `linear-gradient(135deg, ${bg1}, ${bg2})`;
        }

        function updateTheme(){
          const rawScore = parseInt(scoreEl.value, 10);
          const score = isNaN(rawScore) ? undefined : clamp(rawScore, 1, 50);
          const text  = wordEl.value;
          const tone  = toneFromInputs(text, score);
          applyPalette(tone);
        }

        // live updates on input
        wordEl.addEventListener('input', updateTheme);
        scoreEl.addEventListener('input', updateTheme);
        submit.addEventListener('click', updateTheme);

        // If p5 creates a canvas, move it inside #p5-holder and keep it neat
        const holder = document.getElementById('p5-holder');
        const observer = new MutationObserver(() => {
          const cv = document.querySelector('canvas');
          if (cv && holder && cv.parentElement !== holder){
            holder.appendChild(cv);
          }
        });
        observer.observe(document.body, { childList:true, subtree:true });

        // initial paint
        updateTheme();
      })();
    </script>
  </body>
</html>
