<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Share Your Love</title>

  <!-- p5.js (kept from your original) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/addons/p5.sound.min.js" defer></script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#eef7ff;
      --bg2:#fdf7ff;
      --card:#ffffffee;
      --ink:#0f172a;
      --muted:#5b6b7b;
      --brand:#6aa9ff;
      --accent:#ff9aa2;
      --ring: 0 0 0 8px rgba(106,169,255,.15);
      --radius: 22px;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
      color:var(--ink);
      background: radial-gradient(1200px 800px at 10% 0%, var(--bg1), transparent),
                  radial-gradient(1000px 700px at 100% 100%, var(--bg2), transparent),
                  linear-gradient(180deg, #f7fbff, #fff);
      overflow-x:hidden;
    }

    header{
      max-width: 920px;
      margin: clamp(16px, 3vh, 32px) auto 0;
      padding: 0 20px;
      text-align:center;
    }
    .headline{
      font-family: "Playfair Display", serif;
      font-weight: 700;
      font-size: clamp(26px, 4.2vw, 44px);
      line-height: 1.15;
      letter-spacing: .2px;
      margin: 10px auto 8px;
      background: linear-gradient(90deg, #5aa7ff, #a18cff 35%, #ffa7b3 80%);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .tagline{
      max-width: 760px;
      margin: 0 auto 24px;
      color: var(--muted);
      font-size: clamp(14px, 1.8vw, 16px);
    }

    main{
      max-width: 920px;
      margin: 0 auto;
      padding: 16px 20px 40px;
      display:grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }

    .card{
      position: relative;
      background: var(--card);
      border: 1px solid rgba(15,23,42,.06);
      box-shadow:
        0 10px 25px rgba(25, 69, 120, .08),
        0 1px 2px rgba(15,23,42,.06);
      border-radius: var(--radius);
      overflow: clip;
      backdrop-filter: blur(8px);
    }
    .card .in{
      padding: clamp(18px, 3.2vw, 28px);
    }
    .subtle{
      color: var(--muted);
      font-size: .95rem;
      margin: .2rem 0 1rem;
    }

    form{
      display:grid;
      gap: 16px;
    }
    label{
      font-weight: 600;
      font-size: .98rem;
      display:flex;
      align-items:center;
      gap:.5rem;
    }

    .field{
      display:flex;
      flex-direction: column;
      gap:10px;
    }

    textarea, input[type="text"]{
      width:100%;
      border: 1px solid rgba(15,23,42,.12);
      background: #fff;
      border-radius: 16px;
      padding: 14px 16px;
      font: inherit;
      resize: vertical;
      min-height: 100px;
      outline: none;
      transition: box-shadow .15s ease, border-color .15s ease, transform .02s ease;
    }
    textarea:focus, input[type="text"]:focus{
      border-color: var(--brand);
      box-shadow: var(--ring);
    }

    .sliderRow{
      display:grid;
      grid-template-columns: 1fr clamp(68px, 13vw, 96px);
      gap: 14px;
      align-items: center;
    }
    input[type="range"]{
      width:100%;
      accent-color: var(--brand);
    }
    .num{
      display:flex;
      align-items:center;
      gap: 8px;
      justify-content:flex-end;
      color: var(--muted);
      font-size:.95rem;
    }
    .num input{
      width: 70px;
      text-align:center;
      border: 1px solid rgba(15,23,42,.12);
      border-radius: 12px;
      padding: 10px 8px;
      font: inherit;
      outline:none;
    }
    .num input:focus{ border-color: var(--brand); box-shadow: var(--ring); }

    .actions{
      display:flex;
      gap: 10px;
      justify-content: flex-end;
      align-items:center;
      flex-wrap: wrap;
    }
    .btn{
      appearance: none;
      border: none;
      padding: 12px 18px;
      border-radius: 14px;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      transition: transform .06s ease, box-shadow .2s ease, filter .2s ease;
      box-shadow: 0 8px 16px rgba(106,169,255,.25);
      background: linear-gradient(180deg, #6aa9ff, #5a9bff);
      color: #fff;
    }
    .btn:hover{ filter: brightness(1.05); }
    .btn:active{ transform: translateY(1px); }
    .btn.secondary{
      background: #ffffff;
      color: var(--ink);
      border: 1px solid rgba(15,23,42,.12);
      box-shadow: none;
    }

    .counter{
      text-align:right;
      color: var(--muted);
      font-size: .88rem;
      margin-top: -8px;
    }

    .output{
      display: grid;
      gap: 12px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius: 999px;
      font-size:.9rem;
      background: rgba(106,169,255,.12);
      border: 1px solid rgba(106,169,255,.25);
      width: max-content;
    }
    .share{
      background: linear-gradient(180deg, #ffd6db, #ffc8cf);
      border: 1px solid rgba(255, 154, 162, .35);
      padding: 14px 16px;
      border-radius: 16px;
      color:#5a1e26;
    }
    .canvas-wrap{
      position: relative;
      min-height: 220px;
      border-top: 1px dashed rgba(15,23,42,.1);
    }
    .canvas-wrap .hint{
      position:absolute;
      inset: 0;
      display:grid;
      place-items:center;
      color: var(--muted);
      font-size: .9rem;
      pointer-events: none;
    }

    footer{
      text-align:center;
      color: var(--muted);
      font-size:.85rem;
      padding: 16px 0 40px;
    }

    @media (min-width: 900px){
      main{
        grid-template-columns: 1.15fr .85fr;
        gap: 18px;
      }
    }
  </style>
</head>
<body>
  <noscript>
    <div style="padding:12px 16px; background:#fff0f1; color:#8a2430; text-align:center">
      This page works best with JavaScript enabled.
    </div>
  </noscript>

  <header>
    <h1 class="headline">&lt;‚Ä¶I hope you can share your love here‚Ä¶&gt;</h1>
    <p class="tagline">
      If you knew someone might have a hard night with depression or suicidal thoughts, what comforting words would you offer?
      Your words could be for a friend, a family member, or anyone who needs a gentle light.
    </p>
  </header>

  <main>
    <!-- Input Card -->
    <section class="card" aria-labelledby="formTitle">
      <div class="in">
        <h2 id="formTitle" style="margin:0 0 6px; font-size:1.1rem;">Share a hopeful message</h2>
        <p class="subtle">Write a short note of care. Simple is powerful: ‚ÄúI‚Äôm here. You matter.‚Äù</p>

        <form id="loveForm" novalidate>
          <div class="field">
            <label for="word">Your message</label>
            <textarea id="word" name="word" maxlength="240" placeholder="Write something kind, hopeful, and non-judgmental‚Ä¶" aria-describedby="wordCount"></textarea>
            <div id="wordCount" class="counter">0 / 240</div>
          </div>

          <div class="field">
            <label for="scoreRange">If feelings were a number (1‚Äì50), what‚Äôs yours?</label>
            <div class="sliderRow">
              <input id="scoreRange" type="range" min="1" max="50" value="25" />
              <div class="num">
                <span aria-hidden="true">Value</span>
                <input id="scoreNum" type="number" min="1" max="50" value="25" aria-label="Feelings number (1 to 50)">
              </div>
            </div>
          </div>

          <div class="actions">
            <button type="button" class="btn secondary" id="clearBtn" aria-label="Clear inputs">Clear</button>
            <button type="submit" class="btn" id="submit">Share</button>
          </div>
        </form>
      </div>

      <div class="canvas-wrap">
        <div class="hint" id="canvasHint">Your message will bloom here ‚ú®</div>
        <!-- p5 canvas mounts here -->
        <div id="p5-holder"></div>
      </div>
    </section>

    <!-- Output Card -->
    <section class="card" aria-labelledby="outTitle">
      <div class="in">
        <h2 id="outTitle" style="margin:0 0 6px; font-size:1.1rem;">Your gentle light</h2>
        <p class="subtle">What you share can help someone feel less alone. Thank you. üíô</p>

        <div class="output">
          <div class="pill" id="scoreBadge" aria-live="polite">Feeling number: 25</div>
          <div class="share" id="shareText">
            Try sharing a simple note like: <em>‚ÄúI‚Äôm here with you. You are not a burden.‚Äù</em>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    If you or someone you know is in immediate danger, please contact your local emergency number. In Korea: <strong>1393</strong> (Lifeline). You matter.
  </footer>

  <script>
    // ---------- Form Logic & UI ----------
    const word = document.getElementById('word');
    const wordCount = document.getElementById('wordCount');
    const scoreRange = document.getElementById('scoreRange');
    const scoreNum = document.getElementById('scoreNum');
    const scoreBadge = document.getElementById('scoreBadge');
    const shareText = document.getElementById('shareText');
    const form = document.getElementById('loveForm');
    const clearBtn = document.getElementById('clearBtn');
    const canvasHint = document.getElementById('canvasHint');

    const fallbacks = [
      "I‚Äôm here with you. You are not a burden.",
      "You matter more than you know. I‚Äôm glad you‚Äôre here.",
      "It‚Äôs okay to feel this way. You don‚Äôt have to go through it alone.",
      "Your story isn‚Äôt over. Let‚Äôs take tonight moment by moment.",
      "You are loved, needed, and seen‚Äîright now, exactly as you are.",
      "Breathe with me. We can get through this together."
    ];

    function updateCount(){
      wordCount.textContent = `${word.value.length} / ${word.maxLength}`;
    }
    word.addEventListener('input', updateCount);
    updateCount();

    function clamp(val, min, max){
      return Math.max(min, Math.min(max, val));
    }
    function syncFromRange(){
      scoreNum.value = scoreRange.value;
      updateScoreBadge();
    }
    function syncFromNum(){
      const v = clamp(parseInt(scoreNum.value || scoreRange.value, 10), 1, 50);
      scoreNum.value = v;
      scoreRange.value = v;
      updateScoreBadge();
    }
    function updateScoreBadge(){
      const v = parseInt(scoreRange.value, 10);
      scoreBadge.textContent = `Feeling number: ${v}`;
      // Color tilt from calm (blue) to warm (pink)
      const pct = (v - 1) / 49;
      const bg = `linear-gradient(90deg, rgba(106,169,255,${.25 + .25*pct}), rgba(255,154,162,${.25 + .25*(1-pct)}))`;
      scoreBadge.style.background = bg;
      scoreBadge.style.border = "1px solid rgba(15,23,42,.12)";
    }
    scoreRange.addEventListener('input', syncFromRange);
    scoreNum.addEventListener('input', syncFromNum);
    updateScoreBadge();

    clearBtn.addEventListener('click', () => {
      word.value = "";
      scoreRange.value = 25;
      syncFromRange();
      updateCount();
      shareText.innerHTML = `Try sharing a simple note like: <em>‚Äú${fallbacks[0]}‚Äù</em>`;
    });

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const msg = word.value.trim();
      const score = parseInt(scoreRange.value, 10);

      const safe = msg || fallbacks[Math.floor(Math.random()*fallbacks.length)];
      shareText.textContent = safe;

      // Trigger some hearts in p5 with intensity driven by score
      if (window.HEARTS && typeof window.HEARTS.burst === 'function'){
        window.HEARTS.burst(score);
      }
      canvasHint.style.opacity = '0';
    });

    // ---------- p5.js: gentle hearts ----------
    // Creates a soft heart particle field; on submit, it bursts more hearts.
    let sketch = (p) => {
      const hearts = [];
      let holder;

      const Heart = function(x, y, s, hue, vy){
        this.x = x;
        this.y = y;
        this.s = s;
        this.hue = hue;
        this.vy = vy;
        this.alpha = 255;
        this.ax = p.random(-0.02, 0.02);
        this.vx = p.random(-0.3, 0.3);
        this.spin = p.random(-0.01, 0.01);
        this.angle = p.random(p.TWO_PI);
      };
      Heart.prototype.step = function(){
        this.vx += this.ax;
        this.x += this.vx;
        this.y -= this.vy;
        this.vy *= 0.995;
        this.angle += this.spin;
        this.alpha -= 0.65;
      };
      Heart.prototype.draw = function(){
        p.push();
        p.translate(this.x, this.y);
        p.rotate(this.angle);
        p.noStroke();
        p.fill(this.hue, 60, 100, this.alpha/255 * 0.9);
        heartShape(0,0,this.s);
        p.pop();
      };

      function heartShape(x, y, size){
        const s = size;
        p.beginShape();
        for (let a = 0; a < p.TWO_PI; a += 0.1){
          const r = (16 * p.pow(p.sin(a), 3));
          const b = (13 * p.cos(a) - 5 * p.cos(2*a) - 2 * p.cos(3*a) - p.cos(4*a));
          const hx = x + (r * s) * 0.7;
          const hy = y - (b * s) * 0.7;
          p.curveVertex(hx, hy);
        }
        p.endShape(p.CLOSE);
      }

      function baseSpawn(n=2){
        for(let i=0;i<n;i++){
          const x = p.random(p.width);
          const y = p.random(p.height * 0.35, p.height * 0.95);
          hearts.push(new Heart(
            x, y,
            p.random(0.6, 1.1),
            p.random(330, 360), // pink-ish hues in HSB
            p.random(0.4, 1.0)
          ));
        }
      }

      p.setup = function(){
        holder = p.select('#p5-holder');
        const cnv = p.createCanvas(holder.elt.clientWidth, 260);
        cnv.parent('p5-holder');
        p.colorMode(p.HSB, 360,100,100,1);
        p.frameRate(60);
        for(let i=0;i<60;i++) baseSpawn();
        // Expose API
        window.HEARTS = {
          burst: (score=25) => {
            const intensity = p.map(score, 1, 50, 18, 70);
            for(let i=0;i<intensity;i++){
              const x = p.random(p.width*0.15, p.width*0.85);
              const y = p.random(p.height*0.4, p.height*0.95);
              const hue = p.lerp(210, 350, score/50); // blue -> pink
              hearts.push(new Heart(x,y, p.random(0.8,1.5), hue, p.random(0.6, 1.6)));
            }
          }
        };
      };

      p.windowResized = function(){
        if(holder) p.resizeCanvas(holder.elt.clientWidth, 260);
      };

      p.draw = function(){
        p.clear();
        // soft background sheen
        p.noStroke();
        p.fill(216, 100, 98, 0.18);
        p.rect(0,0,p.width,p.height, 24);

        // spawn a few idle hearts
        if (p.frameCount % 10 === 0) baseSpawn(1);

        for (let i = hearts.length - 1; i >= 0; i--){
          const h = hearts[i];
          h.step();
          h.draw();
          if (h.alpha <= 0) hearts.splice(i,1);
        }
      };
    };
    // Delay p5 until the script tag loads (we used defer) and DOM is ready
    window.addEventListener('load', () => new p5(sketch));
  </script>
</body>
</html>
